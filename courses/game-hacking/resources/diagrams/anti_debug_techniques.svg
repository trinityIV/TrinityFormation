<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg width="800" height="600" xmlns="http://www.w3.org/2000/svg">
    <!-- Techniques Anti-Debug -->
    <style>
        text { font-family: Arial, sans-serif; fill: white; }
        .title { font-size: 24px; font-weight: bold; }
        .subtitle { font-size: 18px; }
        .label { font-size: 14px; }
        .box { fill: #2d2d2d; stroke: #0d6efd; stroke-width: 2; }
        .technique { fill: #1a1a1a; stroke: #dc3545; stroke-width: 2; }
        .detection { fill: #1a1a1a; stroke: #28a745; stroke-width: 2; }
        .arrow { stroke: white; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
    </style>

    <!-- Définition de la flèche -->
    <defs>
        <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
            <polygon points="0 0, 10 3.5, 0 7" fill="white"/>
        </marker>
    </defs>

    <!-- Titre -->
    <text x="400" y="50" class="title" text-anchor="middle">Techniques Anti-Debug</text>

    <!-- Centre: Anti-Debug -->
    <circle cx="400" cy="300" r="60" class="box"/>
    <text x="400" y="295" class="subtitle" text-anchor="middle">Anti</text>
    <text x="400" y="315" class="subtitle" text-anchor="middle">Debug</text>

    <!-- Techniques (disposition en cercle) -->
    <!-- API Windows -->
    <rect x="100" y="100" width="160" height="80" class="technique" rx="5"/>
    <text x="180" y="130" class="label" text-anchor="middle">API Windows</text>
    <text x="180" y="150" class="label" text-anchor="middle" font-size="12">IsDebuggerPresent</text>
    <text x="180" y="170" class="label" text-anchor="middle" font-size="12">CheckRemoteDebugger</text>

    <!-- PEB Flags -->
    <rect x="540" y="100" width="160" height="80" class="technique" rx="5"/>
    <text x="620" y="130" class="label" text-anchor="middle">PEB Flags</text>
    <text x="620" y="150" class="label" text-anchor="middle" font-size="12">BeingDebugged</text>
    <text x="620" y="170" class="label" text-anchor="middle" font-size="12">NtGlobalFlag</text>

    <!-- Hardware Breakpoints -->
    <rect x="100" y="400" width="160" height="80" class="detection" rx="5"/>
    <text x="180" y="430" class="label" text-anchor="middle">Hardware Breakpoints</text>
    <text x="180" y="450" class="label" text-anchor="middle" font-size="12">Debug Registers</text>
    <text x="180" y="470" class="label" text-anchor="middle" font-size="12">DR0-DR7</text>

    <!-- Process Detection -->
    <rect x="540" y="400" width="160" height="80" class="detection" rx="5"/>
    <text x="620" y="430" class="label" text-anchor="middle">Process Detection</text>
    <text x="620" y="450" class="label" text-anchor="middle" font-size="12">OllyDbg, x64dbg</text>
    <text x="620" y="470" class="label" text-anchor="middle" font-size="12">IDA, WinDbg</text>

    <!-- Flèches de connexion -->
    <path d="M 180 180 L 350 270" class="arrow"/>
    <path d="M 620 180 L 450 270" class="arrow"/>
    <path d="M 180 400 L 350 330" class="arrow"/>
    <path d="M 620 400 L 450 330" class="arrow"/>

    <!-- Légende -->
    <rect x="600" y="20" width="20" height="20" class="technique"/>
    <text x="630" y="35" class="label" text-anchor="start">Techniques Statiques</text>
    
    <rect x="600" y="50" width="20" height="20" class="detection"/>
    <text x="630" y="65" class="label" text-anchor="start">Détection Active</text>
</svg>
